unit Unit4;

interface

uses
  Winapi.Windows, Winapi.Messages,  Vcl.Menus, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.DBCtrls, Vcl.StdCtrls,
  VclTee.TeeGDIPlus, VCLTee.TeEngine, Vcl.ExtCtrls, VCLTee.TeeProcs,
  VCLTee.Chart, VCLTee.DBChart, Vcl.Grids, Vcl.DBGrids, VCLTee.Series,
  Vcl.ComCtrls,Excel2000,ComObj, Vcl.Buttons;

type
  TPultUpav = class(TForm)
    MainMenu1: TMainMenu;
    N11: TMenuItem;
    N21: TMenuItem;
    N12: TMenuItem;
    N22: TMenuItem;
    PageControlOsnova: TPageControl;
    TabSheet1: TTabSheet;
    PanelBD: TPanel;
    ButtonDimografia: TButton;
    ButtonDinamic: TButton;
    PageControlDinamic: TPageControl;
    TabSheetDinamicTable: TTabSheet;
    Label2: TLabel;
    ComboBoxDinamic: TComboBox;
    StringGridDinamic: TStringGrid;
    TabSheetDinamicChart: TTabSheet;
    ChartDinamic: TChart;
    Label1: TLabel;
    DBLookupComboBoxDinamic: TDBLookupComboBox;
    TabSheetDimografiaTable: TTabSheet;
    StringGridDimografia: TStringGrid;
    Label3: TLabel;
    ComboBoxDimografia: TComboBox;
    Series1: TFastLineSeries;
    TabSheet3: TTabSheet;
    PultPanelScriptINFL: TPanel;
    PultPanelBudgetRegion: TPanel;
    TabSheet4: TTabSheet;
    TabSheet5: TTabSheet;
    TabSheet6: TTabSheet;
    Label4: TLabel;
    Label5: TLabel;
    BoxScriptINFL: TComboBox;
    BitBtn1: TBitBtn;
    Label6: TLabel;
    Label7: TLabel;
    BoxYearStartProject: TComboBox;
    Label8: TLabel;
    BoxScriptInvesticFB: TComboBox;
    Label9: TLabel;
    BoxTempPoctDoxodOtStartEkonom: TComboBox;
    Label10: TLabel;
    BoxScriptTransferAndInvest: TComboBox;
    BitBtn2: TBitBtn;
    PultPanelNONProductSfer: TPanel;
    Label11: TLabel;
    Label12: TLabel;
    BoxScriptDoliNS: TComboBox;
    Label13: TLabel;
    BoxScriptReadGilaZaCheat: TComboBox;
    PultPanelScriptRostTarif: TPanel;
    Label14: TLabel;
    Label15: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    Label18: TLabel;
    Label19: TLabel;
    Label20: TLabel;
    Label21: TLabel;
    BoxGKXScriptTarif: TComboBox;
    BoxHkolaScriptTarif: TComboBox;
    BoxObheeObrozScriptTarif: TComboBox;
    BoxBolnicScriptTarif: TComboBox;
    BoxPoliclinScriptTarif: TComboBox;
    BoxKyltScriptTarif: TComboBox;
    BoxFizKeltScriptTarif: TComboBox;
    PultPanelScriptZP: TPanel;
    Label22: TLabel;
    PageControl1: TPageControl;
    TabSheet7: TTabSheet;
    Chart1: TChart;
    FastLineSeries1: TFastLineSeries;
    TabSheet9: TTabSheet;
    StringGridDinamicObecpec: TStringGrid;
    CheckBox1: TCheckBox;
    CheckBox2: TCheckBox;
    CheckBox3: TCheckBox;
    CheckBox4: TCheckBox;
    CheckBox5: TCheckBox;
    CheckBox6: TCheckBox;
    CheckBox7: TCheckBox;
    ScrollBox1: TScrollBox;
    BoxFizKeltScriptPoctZP: TComboBox;
    BoxKyltScriptPoctZP: TComboBox;
    BoxPoliclinScriptPoctZP: TComboBox;
    BoxBolnicScriptPoctZP: TComboBox;
    BoxObheeObrozScriptPoctZP: TComboBox;
    BoxHkolaScriptPoctZP: TComboBox;
    BoxGKXScriptPoctZP: TComboBox;
    Label23: TLabel;
    Label24: TLabel;
    Label25: TLabel;
    Label26: TLabel;
    Label27: TLabel;
    Label28: TLabel;
    Label29: TLabel;
    Button1: TButton;
    TabSheet8: TTabSheet;
    StringGrid1: TStringGrid;
    procedure FormCreate(Sender: TObject);
    procedure DBLookupComboBoxDinamicClick(Sender: TObject);
    procedure ComboBoxDinamicClick(Sender: TObject);
    procedure ButtonDinamicClick(Sender: TObject);
    procedure ButtonDimografiaClick(Sender: TObject);
    procedure ComboBoxDimografiaClick(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure BoxScriptINFLClick(Sender: TObject);
    procedure BoxYearStartProjectClick(Sender: TObject);
    procedure BoxScriptInvesticFBClick(Sender: TObject);
    procedure BoxTempPoctDoxodOtStartEkonomClick(Sender: TObject);
    procedure BoxScriptTransferAndInvestClick(Sender: TObject);
    procedure BoxScriptDoliNSClick(Sender: TObject);
    procedure BoxScriptReadGilaZaCheatClick(Sender: TObject);
    procedure BoxHkolaScriptTarifClick(Sender: TObject);
    procedure BoxGKXScriptTarifClick(Sender: TObject);
    procedure BoxObheeObrozScriptTarifClick(Sender: TObject);
    procedure BoxBolnicScriptTarifClick(Sender: TObject);
    procedure BoxPoliclinScriptTarifClick(Sender: TObject);
    procedure BoxKyltScriptTarifClick(Sender: TObject);
    procedure BoxFizKeltScriptTarifClick(Sender: TObject);
    procedure BoxHkolaScriptPoctZPClick(Sender: TObject);
    procedure BoxObheeObrozScriptPoctZPClick(Sender: TObject);
    procedure BoxBolnicScriptPoctZPClick(Sender: TObject);
    procedure BoxPoliclinScriptPoctZPClick(Sender: TObject);
    procedure BoxKyltScriptPoctZPClick(Sender: TObject);
    procedure BoxFizKeltScriptPoctZPClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure BitBtn2Click(Sender: TObject);
    procedure CheckBox2Click(Sender: TObject);







  private
    { Private declarations }
  public
  end;

var
PultUpav: TPultUpav;
FXlsApp,sheet: variant;
implementation
uses Unit2, FunctionModel, DinamicPoOtrasl, Dimografia, PultScriptINF,
  PultKraevoiBudzet, PultNONProductSfer, PultScriptRostTarif, PultPanelScriptZP;
{$R *.dfm}
 //------------------------------------------------------------------------------ Фукция для конекта с экселями
  //------------------------------------------------------------------------------ Пульт вкладка Сценарий роста зарплат в БС
  procedure TPultUpav.BoxHkolaScriptPoctZPClick(Sender: TObject);//Дошкольные учреждения
begin
BoxHkolaScriptPoctZPClik;//PultPanelScriptZP
end;
procedure TPultUpav.BoxObheeObrozScriptPoctZPClick(Sender: TObject);//Общее образование
begin
BoxObheeObrozScriptPoctZPClik;//PultPanelScriptZP
end;


procedure TPultUpav.BoxBolnicScriptPoctZPClick(Sender: TObject);//   Больницы
begin
BoxBolnicScriptPoctZPClik;//PultPanelScriptZP
end;
procedure TPultUpav.BoxPoliclinScriptPoctZPClick(Sender: TObject);//   Полиники
begin
BoxPoliclinScriptPoctZPClik;//PultPanelScriptZP
end;
procedure TPultUpav.BoxKyltScriptPoctZPClick(Sender: TObject);//Культура
begin
BoxKyltScriptPoctZPClik;//PultPanelScriptZP
end;
procedure TPultUpav.BoxFizKeltScriptPoctZPClick(Sender: TObject);//Физическая культура
begin
BoxFizKeltScriptPoctZPClik;//PultPanelScriptZP
end;
 //------------------------------------------------------------------------------ Пульт вкладка Сценарии роста тарифов
procedure TPultUpav.BoxGKXScriptTarifClick(Sender: TObject);//ЖКХ
begin
BoxGKXScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxHkolaScriptTarifClick(Sender: TObject);//Дошкольные учреждения
begin
BoxHkolaScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxObheeObrozScriptTarifClick(Sender: TObject);//Общее образование
begin
BoxObheeObrozScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxBolnicScriptTarifClick(Sender: TObject);//   Больницы
begin
BoxBolnicScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxPoliclinScriptTarifClick(Sender: TObject);//   Полиники
begin
BoxPoliclinScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxKyltScriptTarifClick(Sender: TObject);//Культура
begin
BoxKyltScriptTarifClik;//PultScriptRostTarif
end;
procedure TPultUpav.BoxFizKeltScriptTarifClick(Sender: TObject);//Физическая культура
begin
BoxFizKeltScriptTarifClik;//PultScriptRostTarif
end;

//------------------------------------------------------------------------------ Пульт вкладка Непроизводственная сфера
procedure TPultUpav.BoxScriptDoliNSClick(Sender: TObject); //Сценарий  доли НС
begin
BoxScriptDoliNSClik//PultNONProductSfer
end;
procedure TPultUpav.BoxScriptReadGilaZaCheatClick(Sender: TObject);//Сценарий ввода жилья за счет населения
begin
BoxScriptReadGilaZaCheatClik;//PultNONProductSfer
end;
  //------------------------------------------------------------------------------ Пульт вкладка Краевой бюджет
procedure TPultUpav.BitBtn2Click(Sender: TObject); //Подсказка
begin
BitBtn2Clic;
end;
 procedure TPultUpav.BoxYearStartProjectClick(Sender: TObject);//Год старта проектов МСБ
begin
BoxYearStartProjectClik//PultKraevoiBudzet
end;
procedure TPultUpav.BoxScriptInvesticFBClick(Sender: TObject);//Cценарий инвестиций ФБ в МСБ
begin
BoxScriptInvesticFBClik//PultKraevoiBudzet
end;


procedure TPultUpav.BoxTempPoctDoxodOtStartEkonomClick(Sender: TObject);//Темп роста собственных доходов от старой экономики
begin
BoxTempPoctDoxodOtStartEkonomClik;//PultKraevoiBudzet
end;


procedure TPultUpav.BoxScriptTransferAndInvestClick(Sender: TObject);//Сценарий трансфертов и инвестиций
begin
BoxScriptTransferAndInvestClik;//PultKraevoiBudzet
end;

//------------------------------------------------------------------------------ Пульт вкладка Сценарии инфляции бокс сценарии


procedure TPultUpav.BoxScriptINFLClick(Sender: TObject);
begin
BoxScriptINFLClik//PultScriptINF
end;
 procedure TPultUpav.BitBtn1Click(Sender: TObject); //Подсказка
begin
BitBtn1Clic;
end;
//------------------------------------------------------------------------------ Активация контроллера Демография


procedure TPultUpav.ButtonDimografiaClick(Sender: TObject);
begin
DimografiaButtonActiv;// FunctionModel
end;
//------------------------------------------------------------------------------ Активация контроллера Динамика по отраслям
procedure TPultUpav.ButtonDinamicClick(Sender: TObject);
begin
DinamicButtonActiv;// FunctionModel
end;
//------------------------------------------------------------------------------ Выбор из бокса показатель пункта Димография


procedure TPultUpav.ComboBoxDimografiaClick(Sender: TObject);
begin
ComboBoxDimografiaClickk;//Dimografia
end;
//------------------------------------------------------------------------------ Выбор из бокса показатель пункта Динамика по отраслям
procedure TPultUpav.ComboBoxDinamicClick(Sender: TObject);
begin
ComboBoxDinamicClickk;//DinamicPoOtrasl
end;
//------------------------------------------------------------------------------ Выбор из бокса отрасль пункта Динамика по отраслям
procedure TPultUpav.DBLookupComboBoxDinamicClick(Sender: TObject);
begin
DBLookupComboBoxDinamicClickk;//DinamicPoOtrasl
end;
//------------------------------------------------------------------------------ Создание формы
procedure TPultUpav.FormCreate(Sender: TObject);
var S:integer;
begin
SettingCreate;// FunctionModel

StringGrid1.ColWidths[0] := 200;
StringGrid1.ColWidths[1] := 130;
StringGrid1.ColWidths[2] := 130;
StringGrid1.ColWidths[3] := 200;

PultUpav.StringGrid1.Cells[0,0]:='Наименование отрасли';
PultUpav.StringGrid1.Cells[0,1]:='Жилье';
PultUpav.StringGrid1.Cells[0,2]:='Дошкольные учреждения';
PultUpav.StringGrid1.Cells[0,3]:='Общее образование';
PultUpav.StringGrid1.Cells[0,4]:='Больницы';
PultUpav.StringGrid1.Cells[0,5]:='Поликлиники';
PultUpav.StringGrid1.Cells[0,6]:='Культура';
PultUpav.StringGrid1.Cells[0,7]:='Физическая культура';

PultUpav.StringGrid1.Cells[1,0]:='Эталон';
PultUpav.StringGrid1.Cells[1,1]:='28';
PultUpav.StringGrid1.Cells[1,2]:='0,8';
PultUpav.StringGrid1.Cells[1,3]:='1';
PultUpav.StringGrid1.Cells[1,4]:='0,03';
PultUpav.StringGrid1.Cells[1,5]:='0,05';
PultUpav.StringGrid1.Cells[1,6]:='0,3';
PultUpav.StringGrid1.Cells[1,7]:='0,3';

PultUpav.StringGrid1.Cells[2,0]:='Единицы измерения';
PultUpav.StringGrid1.Cells[2,1]:='кв.м.';
PultUpav.StringGrid1.Cells[2,2]:='мест';
PultUpav.StringGrid1.Cells[2,3]:='мест';
PultUpav.StringGrid1.Cells[2,4]:='мест(коек)';
PultUpav.StringGrid1.Cells[2,5]:='посещений в смену';
PultUpav.StringGrid1.Cells[2,6]:='кв.м.';
PultUpav.StringGrid1.Cells[2,7]:='кв.м.';

PultUpav.StringGrid1.Cells[3,0]:='Прогнозное значение';
PultUpav.StringGrid1.Cells[3,1]:='24,32 ';
PultUpav.StringGrid1.Cells[3,2]:='0,75';
PultUpav.StringGrid1.Cells[3,3]:='0,86';
PultUpav.StringGrid1.Cells[3,4]:='0,02';
PultUpav.StringGrid1.Cells[3,5]:='0,04';
PultUpav.StringGrid1.Cells[3,6]:='0,22';
PultUpav.StringGrid1.Cells[3,7]:='0,22';











end;
procedure TPultUpav.FormDestroy(Sender: TObject);
begin
//FXlsApp.Quit;
end;




//------------------------------------------------------------------------------     TEST







procedure TPultUpav.Button1Click(Sender: TObject);

 var a,s:TLineSeries;
 i:integer;
begin
    PultUpav.StringGridDinamicObecpec.Cells[1,1] :='0';
    PultUpav.StringGridDinamicObecpec.Cells[1,2] :='0';


 for i  := 1 to 6 do

If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
   begin
   PultUpav.StringGridDinamicObecpec.Cells[1,i] :='1';
   showmessage ('Обнаружена пустая ячейка!');
   end;


 PultUpav.Chart1.ClearChart;
 a:=TLineSeries.Create(PultUpav.Chart1);
 s:=TLineSeries.Create(PultUpav.Chart1);

for I := 0 to 10 do
a.AddXY(I,i+1);
PultUpav.Chart1.AddSeries(a);
PultUpav.Chart1.View3d:=False;

 for I := 0 to 15 do
 s.AddXY(I,i+2);
 PultUpav.Chart1.AddSeries(s);
 Chart1.Title.Text.Text:='Заголовок';//Название диаграммы
  //Chart1.Title.TextAlignment:='1';

Chart1.Legend.Title.Text.Text:='Название легенды';//Название легенды
Chart1.AxesList.Left.Title.Text:='Ось игрик';
Chart1.AxesList.Bottom.Title.Text:='Ось икс';
Chart1.SeriesList[0].Title:='подпись ';
Chart1.SeriesList[1].Title:='подпись2 ' //подпись линий если их несколько
end;


procedure XlsStart;
begin
FXlsApp := CreateOleObject('Excel.Application');
end;



  procedure TPultUpav.CheckBox2Click(Sender: TObject);
  var
  x,i,k:integer;
  a,b,c,d,e,f,g:TLineSeries;
  znac:string;
begin
znac:='Значение'; //словов значение в табл ячейка 0: n
PultUpav.Chart1.View3d:=False;
PultUpav.Chart1.ClearChart;
  XlsStart;
  FXlsApp.Visible := false;
  //FXlsApp.WorkBooks.Add('');


  b:=TLineSeries.Create(PultUpav.Chart1);
  a:=TLineSeries.Create(PultUpav.Chart1);
  c:=TLineSeries.Create(PultUpav.Chart1);
  d:=TLineSeries.Create(PultUpav.Chart1);
  e:=TLineSeries.Create(PultUpav.Chart1);
  f:=TLineSeries.Create(PultUpav.Chart1);
  g:=TLineSeries.Create(PultUpav.Chart1);
  PultUpav.Chart1.Legend.Title.Text.Text:='Легенда';
PultUpav.Chart1.Legend.Title.Font.Size:=12;
PultUpav.Chart1.Title.Text.Text:='Название диаграммы';
PultUpav.Chart1.Title.Font.Size:=12;
PultUpav.Chart1.AxesList.Left.Title.Text:='';
PultUpav.Chart1.AxesList.Left.Title.Font.Size:=12;
PultUpav.Chart1.AxesList.Bottom.Title.Text:='Года';
PultUpav.Chart1.AxesList.Bottom.Title.Font.Size:=12;
;
begin
with StringGridDinamicObecpec do
  for i:=0 to ColCount-1 do
    Cols[i].Clear;
end;

for x := 0 to PultUpav.StringGridDinamicObecpec.RowCount-1 do
//ringGrid1.Cells[0,x]:=IntToStr(x);
PultUpav.StringGridDinamicObecpec.Cells[0,0]:='Год';
PultUpav.StringGridDinamicObecpec.Cells[1,0]:='2006';
PultUpav.StringGridDinamicObecpec.Cells[2,0]:='2007';
PultUpav.StringGridDinamicObecpec.Cells[3,0]:='2008';
PultUpav.StringGridDinamicObecpec.Cells[4,0]:='2009';
PultUpav.StringGridDinamicObecpec.Cells[5,0]:='2010';
PultUpav.StringGridDinamicObecpec.Cells[6,0]:='2011';
PultUpav.StringGridDinamicObecpec.Cells[7,0]:='2012';
PultUpav.StringGridDinamicObecpec.Cells[8,0]:='2013';
PultUpav.StringGridDinamicObecpec.Cells[9,0]:='2014';
PultUpav.StringGridDinamicObecpec.Cells[10,0]:='2015';
PultUpav.StringGridDinamicObecpec.Cells[11,0]:='2016';
PultUpav.StringGridDinamicObecpec.Cells[12,0]:='2017';
PultUpav.StringGridDinamicObecpec.Cells[13,0]:='2018';
PultUpav.StringGridDinamicObecpec.Cells[14,0]:='2019';
PultUpav.StringGridDinamicObecpec.Cells[15,0]:='2020';
PultUpav.StringGridDinamicObecpec.Cells[16,0]:='2021';
PultUpav.StringGridDinamicObecpec.Cells[17,0]:='2022';
PultUpav.StringGridDinamicObecpec.Cells[18,0]:='2023';
PultUpav.StringGridDinamicObecpec.Cells[19,0]:='2024';
PultUpav.StringGridDinamicObecpec.Cells[20,0]:='2025';
PultUpav.StringGridDinamicObecpec.Cells[21,0]:='2026';
PultUpav.StringGridDinamicObecpec.Cells[22,0]:='2027';
PultUpav.StringGridDinamicObecpec.Cells[23,0]:='2028';
PultUpav.StringGridDinamicObecpec.Cells[24,0]:='2029';
PultUpav.StringGridDinamicObecpec.Cells[25,0]:='2030';
PultUpav.StringGridDinamicObecpec.Cells[26,0]:='2031';

//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox2.Checked then       //Жилой фонд
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;

 for I := 1 to 26 do
a.AddXY(2006+i,FXlsApp.Cells[4,2+i]);
PultUpav.Chart1.AddSeries(a);
PultUpav.Chart1.View3d:=False;
FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[69,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox3.Checked then  //Дошкольное образование
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;

 for I := 1 to 26 do
b.AddXY(2006+i,FXlsApp.Cells[5,2+i]);
PultUpav.Chart1.AddSeries(b);
PultUpav.Chart1.View3d:=False;
FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[70,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox1.Checked then   //Общее полное образование
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;
 for I := 1 to 26 do
c.AddXY(2006+i,FXlsApp.Cells[6,2+i]);
PultUpav.Chart1.AddSeries(c);
PultUpav.Chart1.View3d:=False;

FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[71,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox4.Checked then //больница
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;

 for I := 1 to 26 do
d.AddXY(2006+i,FXlsApp.Cells[7,2+i]);
PultUpav.Chart1.AddSeries(d);
PultUpav.Chart1.View3d:=False;


FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[72,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox5.Checked then //поликлиника
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;

 for I := 1 to 26 do
e.AddXY(2006+i,FXlsApp.Cells[8,2+i]);
PultUpav.Chart1.AddSeries(e);
PultUpav.Chart1.View3d:=False;


FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[73,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox6.Checked then //культура
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;

 for I := 1 to 26 do
f.AddXY(2006+i,FXlsApp.Cells[9,2+i]);
PultUpav.Chart1.AddSeries(f);
PultUpav.Chart1.View3d:=False;


FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[74,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
//-----------------------------------------------------------------------------------------------------------------------------
Begin
if CheckBox7.Checked then //Физическая культура
begin
  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\темпы роста сравнение.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[7].Activate;


 for I := 1 to 26 do
g.AddXY(2006+i,FXlsApp.Cells[10,2+i]);
PultUpav.Chart1.AddSeries(g);
PultUpav.Chart1.View3d:=False;


FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;

  FXlsApp.WorkBooks.open(ExtractFilePath(Application.ExeName)+'Модель\Модель_Соц_сфера.xlsx');
  Sheet := FXlsApp.ActiveWorkBook.Sheets;
  Sheet.item[6].Activate;
 begin
 for i  := 1 to 6 do
If PultUpav.StringGridDinamicObecpec.cells[1,i]='' then
break;
   begin
for K := 1 to 26 do
PultUpav.StringGridDinamicObecpec.cells[k,i]:=FormatFloat('0.######',FXlsApp.Cells[75,3]);
PultUpav.StringGridDinamicObecpec.cells[0,i]:=znac;
   end;
 FXlsApp.ActiveWorkbook.Save;
FXlsApp.ActiveWorkbook.Close;
 end;
end
else
End;
end;







  //ShowMessage(PultUpav.Chart1.n)

 //------------------------------------------------------------------------------
end.
