unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.DBCtrls, Vcl.StdCtrls,
  VclTee.TeeGDIPlus, VCLTee.TeEngine, Vcl.ExtCtrls, VCLTee.TeeProcs,
  VCLTee.Chart, VCLTee.DBChart, Vcl.Grids, Vcl.DBGrids, VCLTee.Series,
  Vcl.ComCtrls;

type
  TForm1 = class(TForm)
    Label1: TLabel;
    DBLookupComboBox1: TDBLookupComboBox;
    Button1: TButton;
    PageControl: TPageControl;
    TabSheet1: TTabSheet;
    TabSheet2: TTabSheet;
    Chart: TChart;
    ComboBox1: TComboBox;
    Label2: TLabel;
    Button2: TButton;
    StringGrid1: TStringGrid;
    procedure FormCreate(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure FormResize(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}
uses Unit2,Unit3;



procedure TForm1.Button1Click(Sender: TObject);
begin

if AnsiCompareText('Жилой фонд',Trim(DBLookupComboBox1.Text)) = 0 then
begin
ComboBox1.Items.Clear;
ComboBox1.Items.Add('Мощности непроизводственной сферы на начало года, нат.ед (кв м)');
ComboBox1.Items.Add('Эксплозатраты текущего года - план (тыс.руб)');
ComboBox1.Items.Add('Ввод новых мощностей текущего года ЗА СЧЕТ БЮДЖЕТА- факт, нат.ед.');
ComboBox1.Items.Add('Плата населения (тыс.руб) (ПЛАН)');
ComboBox1.Items.Add('Ввод новых мощностей текущего года ЗА СЧЕТ НАСЕЛЕНИЯ- факт, нат.ед.');
end
else
begin
ComboBox1.Items.Clear;
ComboBox1.Items.Add('Мощности непроизводственной сферы на начало года, нат.ед');
ComboBox1.Items.Add('Эксплозатраты текущего года - план (тыс.руб)');
ComboBox1.Items.Add('ФЗП (тыс. руб.)-план');
ComboBox1.Items.Add('Ввод новых мощностей текущего года - факт, нат.ед.');
ComboBox1.Items.Add('Плата населения (тыс.руб) (ПЛАН)');
ComboBox1.Items.Add('Плата населения (тыс.руб) (факт)');
ComboBox1.Items.Add('Число занятых (тыс. чел)');
end;



end;

procedure TForm1.Button2Click(Sender: TObject);
var i,x:integer;
begin
TabSheet2.TabVisible:=True;




for x := 0 to StringGrid1.RowCount-1 do
//ringGrid1.Cells[0,x]:=IntToStr(x);

StringGrid1.Cells[0,0]:='Год';
StringGrid1.Cells[0,1]:='Значение';
StringGrid1.Cells[1,0]:='2006';
StringGrid1.Cells[2,0]:='2007';
StringGrid1.Cells[3,0]:='2008';
StringGrid1.Cells[4,0]:='2009';
StringGrid1.Cells[5,0]:='2010';
StringGrid1.Cells[6,0]:='2011';
StringGrid1.Cells[7,0]:='2012';
StringGrid1.Cells[8,0]:='2013';
StringGrid1.Cells[9,0]:='2014';
StringGrid1.Cells[10,0]:='2015';
StringGrid1.Cells[11,0]:='2016';
StringGrid1.Cells[12,0]:='2017';
StringGrid1.Cells[13,0]:='2018';
StringGrid1.Cells[14,0]:='2019';
StringGrid1.Cells[15,0]:='2020';
StringGrid1.Cells[16,0]:='2021';
StringGrid1.Cells[17,0]:='2022';
StringGrid1.Cells[18,0]:='2023';
StringGrid1.Cells[19,0]:='2024';
StringGrid1.Cells[20,0]:='2025';
StringGrid1.Cells[21,0]:='2026';
StringGrid1.Cells[21,0]:='2027';
StringGrid1.Cells[21,0]:='2028';
StringGrid1.Cells[21,0]:='2029';
StringGrid1.Cells[21,0]:='2030';
StringGrid1.Cells[21,0]:='2031';
;




// Form3.Show;
// for i := 1 to 26 do
  //        begin
// Chart1.SeriesList[0].AddXY(i, i);
// Label4.Caption:=DBGrid1.Columns[0].Index;
   //       end;
end;

procedure TForm1.FormCreate(Sender: TObject);//При создании
begin
Form1.Position:= poDesktopCenter;
TabSheet2.TabVisible:=False;
Form1.BorderStyle:=bsSingle; //Запрет на растяжение формы
//Form1.Height:=98;

end;

procedure TForm1.FormResize(Sender: TObject);// При изминении размеров формы
begin
//PageControl.Width:=Form1.Width;
//PageControl.Height:=Form1.Height;
//TabSheet2.Height:=PageControl.Height;
//TabSheet2.Width:=PageControl.Width;
Chart.Width:=PageControl.Width;
Chart.Height:=PageControl.Height;
end;

end.





